<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <title>Food Ordering Platform</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="index.css">
</head>
<body>
        <nav class="navbar sticky-top navbar-dark bg-dark">
                <a class="navbar-brand" href="#"><h2>DEV/FOOD</h2></a>
                <a class="navbar-brand" href="./login.html" style = "margin-left: 850px;">LOGIN</a>
                <a class="navbar-brand" href="./index.html">REGISTER</a>
        </nav>
        <div class="header">
        <h3>REGISTER HERE</h3>	
        </div>
    <form action="">
        <div class="User">
            <label>First Name</label>
            <input type="text" name="firstName" id = "firstName">
        </div>
        
        <div class="User">
            <label>Last Name</label>
            <input type="text" name="lastName" id = "lastName">
        </div>

        <div class="User">
            <label>Email</label>
            <input type="text" name="email" id = "email">
        </div>

        <div class="User">
            <label>Phone Number</label>
            <input type="text" name="phoneNumber" id = "phoneNumber">
        </div>
        
        <div class="User">
            <label>Password</label>
            <input type="password" name="password_1" id = "password_1">
        </div>

        <div class="User">
            <label>Confirm Password</label>
            <input type="password" name="password_2" id = "password_2">
        </div>
        
        
        <div class="User">
            <button type="submit" name="submit" class="btn btn-primary btn-success">Register</button>
        </div>
        <p>
            Already registered? <a href="login.html">Login here</a> 
        </p>
    </form>

    <script src = "./jquery-3.4.1.js"></script>
<script>
$(document).ready(function(){
    $('form').on('submit', function(e){
    e.preventDefault();
    let firstName = $('#firstName').val();
    let lastName = $('#lastName').val();
    let email = $('#email').val();
    let phoneNumber = $('#phoneNumber').val();
    let password_1 = $('#password_1').val();
    let password_2 = $('#password_1').val();
    
    $.ajax({
url:"http://localhost:4000/users?email="+email,
success:function(result){
    console.log(result);
    if(result.length){
        return alert("You have created an account before")
    }else{
        $.ajax({
url:"http://localhost:4000/users",
success:function(result){
    console.log(result)
    localStorage.firstName = result[0].firstName;
    localStorage.lastName = result[0].lastName;
    localStorage.email = result[0].email;

},
method:"POST",
data:{
    firstName,
    lastName,
    email,
    phoneNumber,
    password_1,
    password_1,
    "isAdmin":false
},
    });
    }
    },

method:"GET"
})
})

})
</script>
</body>
</html>